{% extends 'base_simple.html' %}

{% block title %}Voice Models - Voice AI Campaign System{% endblock %}

{% block breadcrumbs %}
<a href="{{ url_for('admin.dashboard') }}" class="hover:text-primary-600">Dashboard</a>
<i class="fas fa-chevron-right text-xs text-gray-400 mx-2"></i>
<span class="text-gray-700">Voice Models</span>
{% endblock %}

{% block content %}
<div class="mb-6">
    <div class="flex flex-wrap items-center justify-between gap-4">
        <h2 class="text-xl font-bold text-gray-800">Voice Models</h2>
        <button type="button" class="inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors" onclick="document.getElementById('addVoiceModelModal').classList.remove('hidden')">
            <i class="fas fa-plus mr-2"></i> Train New Voice Model
        </button>
    </div>
</div>

<!-- Voice Models Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
    <!-- Presidential Voice (English) -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
            <h3 class="font-semibold text-gray-800">Presidential Voice (English)</h3>
            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
        </div>
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-600">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-700">English</p>
                        <p class="text-xs text-gray-500">Created: Apr 15, 2025</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-700">5 min</p>
                    <p class="text-xs text-gray-500">Training Data</p>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Sample Audio</p>
                <div class="bg-gray-50 rounded-md p-3 flex items-center">
                    <button class="text-primary-600 hover:text-primary-800 mr-3">
                        <i class="fas fa-play"></i>
                    </button>
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-primary-600 rounded-full" style="width: 30%"></div>
                        </div>
                    </div>
                    <span class="text-xs text-gray-500 ml-3">0:15 / 0:45</span>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Model Quality</p>
                <div class="flex items-center">
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 rounded-full" style="width: 95%"></div>
                        </div>
                    </div>
                    <span class="text-xs font-medium text-gray-700 ml-3">95%</span>
                </div>
            </div>
            
            <div class="flex space-x-2 mt-4">
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors">
                    <i class="fas fa-edit mr-1"></i> Edit
                </button>
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors" onclick="document.getElementById('testVoiceModal').classList.remove('hidden')">
                    <i class="fas fa-flask mr-1"></i> Test Voice
                </button>
                <button class="px-3 py-1.5 bg-red-50 text-red-600 rounded text-xs font-medium hover:bg-red-100 transition-colors">
                    <i class="fas fa-trash-alt mr-1"></i> Delete
                </button>
            </div>
        </div>
    </div>
    
    <!-- Presidential Voice (Luganda) -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
            <h3 class="font-semibold text-gray-800">Presidential Voice (Luganda)</h3>
            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
        </div>
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-600">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-700">Luganda</p>
                        <p class="text-xs text-gray-500">Created: Apr 16, 2025</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-700">4 min</p>
                    <p class="text-xs text-gray-500">Training Data</p>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Sample Audio</p>
                <div class="bg-gray-50 rounded-md p-3 flex items-center">
                    <button class="text-primary-600 hover:text-primary-800 mr-3">
                        <i class="fas fa-play"></i>
                    </button>
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-primary-600 rounded-full" style="width: 50%"></div>
                        </div>
                    </div>
                    <span class="text-xs text-gray-500 ml-3">0:20 / 0:40</span>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Model Quality</p>
                <div class="flex items-center">
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 rounded-full" style="width: 90%"></div>
                        </div>
                    </div>
                    <span class="text-xs font-medium text-gray-700 ml-3">90%</span>
                </div>
            </div>
            
            <div class="flex space-x-2 mt-4">
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors">
                    <i class="fas fa-edit mr-1"></i> Edit
                </button>
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors">
                    <i class="fas fa-flask mr-1"></i> Test Voice
                </button>
                <button class="px-3 py-1.5 bg-red-50 text-red-600 rounded text-xs font-medium hover:bg-red-100 transition-colors">
                    <i class="fas fa-trash-alt mr-1"></i> Delete
                </button>
            </div>
        </div>
    </div>
    
    <!-- Presidential Voice (Swahili) -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
            <h3 class="font-semibold text-gray-800">Presidential Voice (Swahili)</h3>
            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
        </div>
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-600">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-700">Swahili</p>
                        <p class="text-xs text-gray-500">Created: Apr 17, 2025</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-700">3.5 min</p>
                    <p class="text-xs text-gray-500">Training Data</p>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Sample Audio</p>
                <div class="bg-gray-50 rounded-md p-3 flex items-center">
                    <button class="text-primary-600 hover:text-primary-800 mr-3">
                        <i class="fas fa-play"></i>
                    </button>
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-primary-600 rounded-full" style="width: 70%"></div>
                        </div>
                    </div>
                    <span class="text-xs text-gray-500 ml-3">0:28 / 0:40</span>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Model Quality</p>
                <div class="flex items-center">
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                    <span class="text-xs font-medium text-gray-700 ml-3">85%</span>
                </div>
            </div>
            
            <div class="flex space-x-2 mt-4">
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors">
                    <i class="fas fa-edit mr-1"></i> Edit
                </button>
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors">
                    <i class="fas fa-flask mr-1"></i> Test Voice
                </button>
                <button class="px-3 py-1.5 bg-red-50 text-red-600 rounded text-xs font-medium hover:bg-red-100 transition-colors">
                    <i class="fas fa-trash-alt mr-1"></i> Delete
                </button>
            </div>
        </div>
    </div>
    
    <!-- Presidential Voice (Runyankole) -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
            <h3 class="font-semibold text-gray-800">Presidential Voice (Runyankole)</h3>
            <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">Training</span>
        </div>
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-600">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-700">Runyankole</p>
                        <p class="text-xs text-gray-500">Started: Apr 20, 2025</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-700">2 min</p>
                    <p class="text-xs text-gray-500">Training Data</p>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Training Progress</p>
                <div class="flex items-center">
                    <div class="flex-1">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-yellow-500 rounded-full" style="width: 65%"></div>
                        </div>
                    </div>
                    <span class="text-xs font-medium text-gray-700 ml-3">65%</span>
                </div>
            </div>
            
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Estimated Completion</p>
                <p class="text-sm font-medium text-gray-700">2 hours 15 minutes</p>
            </div>
            
            <div class="flex space-x-2 mt-4">
                <button class="px-3 py-1.5 bg-primary-50 text-primary-600 rounded text-xs font-medium hover:bg-primary-100 transition-colors">
                    <i class="fas fa-sync-alt mr-1"></i> Check Status
                </button>
                <button class="px-3 py-1.5 bg-red-50 text-red-600 rounded text-xs font-medium hover:bg-red-100 transition-colors">
                    <i class="fas fa-stop mr-1"></i> Cancel Training
                </button>
            </div>
        </div>
    </div>
    
    <!-- Train New Voice Model Card -->
    <div class="bg-white rounded-lg shadow-sm border border-dashed border-gray-300 overflow-hidden hover:shadow-md transition-shadow">
        <div class="p-8 flex flex-col items-center justify-center h-full">
            <div class="w-16 h-16 rounded-full bg-primary-50 flex items-center justify-center text-primary-600 mb-4">
                <i class="fas fa-microphone-alt text-xl"></i>
            </div>
            <h3 class="font-semibold text-gray-800 mb-2">Train New Voice Model</h3>
            <p class="text-gray-500 text-sm text-center mb-4">Upload audio samples to train a new presidential voice model</p>
            <button onclick="document.getElementById('addVoiceModelModal').classList.remove('hidden')" class="px-4 py-2 bg-primary-600 text-white rounded-md text-sm font-medium hover:bg-primary-700 transition-colors">
                Start Training
            </button>
        </div>
    </div>
</div>

<!-- Add Voice Model Modal -->
<div id="addVoiceModelModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Train New Voice Model</h3>
            <button type="button" class="text-gray-500 hover:text-gray-700" onclick="document.getElementById('addVoiceModelModal').classList.add('hidden')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <form>
            <div class="mb-4">
                <label for="voiceName" class="block text-sm font-medium text-gray-700 mb-1">Voice Model Name</label>
                <input type="text" id="voiceName" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="e.g., Presidential Voice (English)">
            </div>
            
            <div class="mb-4">
                <label for="voiceLanguage" class="block text-sm font-medium text-gray-700 mb-1">Language</label>
                <select id="voiceLanguage" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                    <option value="">Select Language</option>
                    <option value="en">English</option>
                    <option value="lg">Luganda</option>
                    <option value="sw">Swahili</option>
                    <option value="nyn">Runyankole</option>
                </select>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Upload Audio Samples</label>
                <div class="border-2 border-dashed border-gray-300 rounded-md p-6 text-center">
                    <div class="mb-3">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400"></i>
                    </div>
                    <p class="text-sm text-gray-500 mb-2">Drag and drop audio files here, or click to browse</p>
                    <p class="text-xs text-gray-400 mb-3">MP3, WAV, or M4A files (min 3 minutes total)</p>
                    <input type="file" id="audioFiles" multiple class="hidden" accept=".mp3,.wav,.m4a">
                    <button type="button" onclick="document.getElementById('audioFiles').click()" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200 transition-colors">
                        Browse Files
                    </button>
                </div>
            </div>
            
            <div class="mb-4">
                <label for="voiceDescription" class="block text-sm font-medium text-gray-700 mb-1">Description (Optional)</label>
                <textarea id="voiceDescription" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Add notes about this voice model"></textarea>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button type="button" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="document.getElementById('addVoiceModelModal').classList.add('hidden')">Cancel</button>
                <button type="submit" class="px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700">Start Training</button>
            </div>
        </form>
    </div>
</div>

<!-- Test Voice Modal -->
<div id="testVoiceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Test Voice Model</h3>
            <button type="button" class="text-gray-500 hover:text-gray-700" onclick="document.getElementById('testVoiceModal').classList.add('hidden')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="mb-6">
            <p class="text-sm text-gray-700 mb-4">Enter text to convert to speech using the Presidential Voice (English) model.</p>
            
            <textarea rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Enter text to convert to speech...">Hello, my fellow Ugandans. I am excited to speak with you today about our vision for the future of our great nation.</textarea>
        </div>
        
        <div class="mb-6">
            <p class="text-sm font-medium text-gray-700 mb-2">Voice Settings</p>
            
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-xs text-gray-500 mb-1">Speed</label>
                    <input type="range" min="0.5" max="2" step="0.1" value="1" class="w-full">
                </div>
                <div>
                    <label class="block text-xs text-gray-500 mb-1">Pitch</label>
                    <input type="range" min="0.5" max="2" step="0.1" value="1" class="w-full">
                </div>
            </div>
        </div>
        
        <div class="mb-6">
            <button type="button" class="w-full py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors flex items-center justify-center">
                <i class="fas fa-play mr-2"></i> Generate and Play
            </button>
        </div>
        
        <div class="bg-gray-50 rounded-md p-4 mb-4 hidden" id="audioResult">
            <p class="text-sm font-medium text-gray-700 mb-2">Generated Audio</p>
            <div class="flex items-center">
                <button class="text-primary-600 hover:text-primary-800 mr-3">
                    <i class="fas fa-play"></i>
                </button>
                <div class="flex-1">
                    <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                        <div class="h-full bg-primary-600 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                <span class="text-xs text-gray-500 ml-3">0:00 / 0:00</span>
            </div>
            <div class="flex justify-end mt-3">
                <button class="text-sm text-primary-600 hover:text-primary-700">
                    <i class="fas fa-download mr-1"></i> Download
                </button>
            </div>
        </div>
        
        <div class="flex justify-end">
            <button type="button" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="document.getElementById('testVoiceModal').classList.add('hidden')">Close</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Show audio result when Generate and Play is clicked
    document.addEventListener('DOMContentLoaded', function() {
        const generateButton = document.querySelector('#testVoiceModal button.w-full');
        if (generateButton) {
            generateButton.addEventListener('click', function() {
                const audioResult = document.getElementById('audioResult');
                audioResult.classList.remove('hidden');
                
                // Simulate progress
                const progressBar = audioResult.querySelector('.bg-primary-600');
                let width = 0;
                const interval = setInterval(function() {
                    if (width >= 100) {
                        clearInterval(interval);
                    } else {
                        width += 5;
                        progressBar.style.width = width + '%';
                    }
                }, 100);
                
                // Update time display
                const timeDisplay = audioResult.querySelector('.text-xs.text-gray-500');
                let seconds = 0;
                const timeInterval = setInterval(function() {
                    seconds += 1;
                    const currentTime = formatTime(seconds);
                    const totalTime = formatTime(20);
                    timeDisplay.textContent = currentTime + ' / ' + totalTime;
                    
                    if (seconds >= 20) {
                        clearInterval(timeInterval);
                    }
                }, 1000);
            });
        }
    });
    
    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        return minutes + ':' + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;
    }
</script>
{% endblock %}
